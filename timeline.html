<html>
<head>

<meta charset="UTF-8">

<title>Baseball Timeline</title>


<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
     integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
     crossorigin=""/>
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
     integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
     crossorigin=""></script>
	 
<script src="https://skeate.dev/Leaflet.timeline/examples/leaflet.timeline.js"></script>
<script src="leaflet.textpath.js"></script>
<script src="L.Control.Layers.Tree.js"></script>

<link rel="stylesheet" href="L.Control.Layers.Tree.css"/>



<script src="majorleagues/NLandALteams.json" type="text/javascript"></script>
<script src="minorleagues/westernleague1894.json" type="text/javascript"></script>
<script src="minorleagues/pacificcoastleague.json" type="text/javascript"></script>
<script src="minorleagues/alabamatennesseeleague.json" type="text/javascript"></script>
<script src="minorleagues/midwestleague.json" type="text/javascript"></script> 
<script src="minorleagues/internationalleague.json" type="text/javascript"></script> 
<script src="majorleagues/playersleague.json" type="text/javascript"></script>
<script src="majorleagues/americanassociation.json" type="text/javascript"></script>
<script src="minorleagues/centralleague.json" type="text/javascript"></script> 
<script src="minorleagues/carolinaleague.json" type="text/javascript"></script> 
<script src="minorleagues/southatlanticleague.json" type="text/javascript"></script> 
<script src="minorleagues/appalachianleague.json" type="text/javascript"></script> 
<script src="minorleagues/californialeague.json" type="text/javascript"></script> 
<script src="minorleagues/threeileague.json" type="text/javascript"></script> 
<script src="minorleagues/americanassociation.json" type="text/javascript"></script> 
<script src="minorleagues/westernleague.json" type="text/javascript"></script> 
<script src="minorleagues/texasleague.json" type="text/javascript"></script> 
<script src="minorleagues/centralassociation.json" type="text/javascript"></script> 
<script src="minorleagues/interamericanleague.json" type="text/javascript"></script> 

<script src="indyleagues/northcentralleague.json" type="text/javascript"></script> 
<script src="indyleagues/greatcentralleague.json" type="text/javascript"></script> 
<script src="indyleagues/midamericaleague.json" type="text/javascript"></script> 
<script src="indyleagues/prairieleague.json" type="text/javascript"></script> 
<script src="indyleagues/bigsouthleague.json" type="text/javascript"></script> 
<script src="indyleagues/northatlanticleague.json" type="text/javascript"></script> 
<script src="indyleagues/heartlandleague.json" type="text/javascript"></script> 
<script src="indyleagues/texaslouisianaleague.json" type="text/javascript"></script> 
<script src="indyleagues/allamericanassociation.json" type="text/javascript"></script> 
<script src="indyleagues/northernleague.json" type="text/javascript"></script> 
<script src="indyleagues/southcoastleague.json" type="text/javascript"></script> 
<script src="indyleagues/westernbaseballleague.json" type="text/javascript"></script> 
<script src="indyleagues/unitedleaguebaseball.json" type="text/javascript"></script> 
<script src="indyleagues/goldenbaseballleague.json" type="text/javascript"></script>
<script src="indyleagues/northeastleague.json" type="text/javascript"></script>
<script src="indyleagues/atlanticleague.json" type="text/javascript"></script>
<script src="indyleagues/frontierleague.json" type="text/javascript"></script>
<script src="indyleagues/continentalbaseballleague.json" type="text/javascript"></script>



<script src="leagueindex.json" type="text/javascript"></script>

<script src="collegiatesummerleagues/northwoodsleague.json" type="text/javascript"></script>

<div id="map" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;"></div>
    <style>
      .leaflet-bottom.leaflet-left {
        width: 100%;
      }
      .leaflet-control-container .leaflet-timeline-controls {
        box-sizing: border-box;
        width: 100%;
        margin: 0;
        margin-bottom: 15px;
      }
    </style>
	


</head>



<body>

<script>

//creates the actual map
var map = L.map('map').setView([39.833333, -98.583333 ], 5);
//L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
//    maxZoom: 19,
//    attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
//}).addTo(map);

var CartoDB_DarkMatter = L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
	attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',
	subdomains: 'abcd',
	maxZoom: 17
});



var CartoDB_LightMatter = L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
    maxZoom: 17,
    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>'
});


CartoDB_LightMatter.addTo(map);

timelineControl = L.timelineSliderControl({
"start": Date.parse("1832-09-17"),
"end": Date.parse("2025-12-31"),
formatOutput: function (date) {
            return new Date(date+86400000).toLocaleDateString(); //this is a horrific hack
																 //date was off-by-one so I just added an amount of time to line it up
          },
duration: 500000
});



var ballmarkerIcon = L.Icon.extend({
    options: {
        shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png',
		iconSize: [25, 41],
		iconAnchor: [12, 41],
		popupAnchor: [1, -34],
		shadowSize: [41, 41]
    }
});

var greenIcon 			= new ballmarkerIcon({iconUrl: 'markericons/marker-icon-2x-green.png'}),
	redIcon 			= new ballmarkerIcon({iconUrl: 'markericons/marker-icon-2x-red.png'}),
	yellowIcon 			= new ballmarkerIcon({iconUrl: 'markericons/marker-icon-2x-yellow.png'}),
	blackIcon 			= new ballmarkerIcon({iconUrl: 'markericons/marker-icon-2x-black.png'}),
	blueIcon 			= new ballmarkerIcon({iconUrl: 'markericons/marker-icon-2x-blue.png'}),
	goldIcon 			= new ballmarkerIcon({iconUrl: 'markericons/marker-icon-2x-gold.png'}),
	greyIcon 			= new ballmarkerIcon({iconUrl: 'markericons/marker-icon-2x-grey.png'}),
	orangeIcon 			= new ballmarkerIcon({iconUrl: 'markericons/marker-icon-2x-orange.png'}),
	darkgreenIcon 		= new ballmarkerIcon({iconUrl: 'markericons/marker-icon-2x-darkgreen.png'}),
	aquamarineIcon 		= new ballmarkerIcon({iconUrl: 'markericons/marker-icon-2x-aquamarine.png'}),
	pinkIcon 			= new ballmarkerIcon({iconUrl: 'markericons/marker-icon-2x-pink.png'}),
	violetIcon 			= new ballmarkerIcon({iconUrl: 'markericons/marker-icon-2x-violet.png'});
	darkblueIcon 		= new ballmarkerIcon({iconUrl: 'markericons/marker-icon-2x-darkblue.png'});
	brownIcon 			= new ballmarkerIcon({iconUrl: 'markericons/marker-icon-2x-brown.png'});
	brightorangeIcon 	= new ballmarkerIcon({iconUrl: 'markericons/marker-icon-2x-brightorange.png'});
	hotpinkIcon		 	= new ballmarkerIcon({iconUrl: 'markericons/marker-icon-2x-hotpink.png'});
	lightpinkIcon		 = new ballmarkerIcon({iconUrl: 'markericons/marker-icon-2x-lightpink.png'});
	
var defunctIcon		= new L.Icon({iconUrl: 'defunct1.png', iconAnchor: [15, 35]});
var birthIcon 		= new L.Icon({iconUrl: 'birthIcon.png'});
var exclamationIcon = new L.Icon({iconUrl: 'exclamation.png'});
var newleagueIcon 	= new L.Icon({iconUrl: 'newleague.png'});
var relocateIcon 	= new L.Icon({iconUrl: 'relocate.png'});
var rebrandIcon 	= new L.Icon({iconUrl: 'rebrand.png'});


var ALIcon = new L.Icon({
  iconUrl: 'markericons/ALIcon.png',
  shadowUrl: '',
  iconSize: [50, 50],
  iconAnchor: [25, 25],
  popupAnchor: [1, -34],
  shadowSize: [41, 41]
});

var NLIcon = new L.Icon({
  iconUrl: 'markericons/NLIcon.png',
  shadowUrl: '',
  iconSize: [50, 50],
  iconAnchor: [25, 25],
  popupAnchor: [1, -34],
  shadowSize: [41, 41]
});

var NorthwoodsIcon = new L.Icon({
  iconUrl: 'markericons/NorthwoodsIcon.png',
  shadowUrl: '',
  iconSize: [0, 0],
  iconAnchor: [25, 25],
  popupAnchor: [1, -34],
  shadowSize: [41, 41]
});

var NoLeague						= {"type": 'FeatureCollection', "features": []} //gotta keep this guy

function addGeoJSONTeamsToLeagues (geoJSONTeam, league) {
	for  (let i = 0; i < leagueIndex.leagues.length; i++) {
		if (leagueIndex.leagues[i].name == league) {
			leagueIndex.leagues[i].properties.leagueGeoJSONArray.features.push(geoJSONTeam);
			}
	}
	switch (league) {case "noLeague": NoLeague.features.push(geoJSONTeam); break; }} //exists just to handle the leagues UI update


function convertTeamToGeoJSON(team, nameArray, leagueArray, coordArray){ 
	let latlng 		= 	[coordArray[0][1], coordArray[0][0]];
	let nameStart 	= 	cleanDates(nameArray[1], 	"start");
	let nameEnd 	= 	cleanDates(nameArray[2], 	"end");
	let leagueStart =	cleanDates(leagueArray[1], 	"start");
	let leagueEnd 	= 	cleanDates(leagueArray[2], 	"end");
	let coordStart 	= 	cleanDates(coordArray[1], 	"start");
	let coordEnd 	= 	cleanDates(coordArray[2], 	"end");
	startTime		= 	Math.max(nameStart,leagueStart,coordStart);
	endTime 		= 	Math.min(nameEnd,leagueEnd,coordEnd);
	let geoJSONteam = { 
		"type": "Feature",
	    "properties": 	{"start": startTime, "end": endTime, "name": nameArray[0], "league": leagueArray[0]},
		"geometry" : 	{"coordinates" : latlng, "type": "Point"}} 
	addGeoJSONTeamsToLeagues(geoJSONteam, leagueArray[0]);
	return geoJSONteam;
}

function cleanDates (time, type) {
	if (type == "start") {
		if (time.length == 4) 
			{return Date.parse(time.concat("-01-01"))};
		return Date.parse(time)}
	if (type == "end") {
		if (time.length == 4) 
			{return Date.parse(time.concat("-12-31"))};
		if (time == "now") 
			{return Date.parse("2025-12-31")};
		return Date.parse(time) }
	else 	{return Date.parse(time)}}
	

function drawCoordMovingLines(latlon1, latlon2, time, league, nextleague, name){ //nextleague can be the same as league
	let movingLine = 	
		{ "type": "LineString",
	     "properties": {
			"start": time,
			"end": time,
			"decoration": "arrow"
			}, 
		"coordinates": [[latlon1[1], latlon1[0]],[latlon2[1], latlon2[0]]]
		}
	addGeoJSONTeamsToLeagues(movingLine, league);			//line goes with the departing league
	//let nameArray = [name, time, time]
	//let leagueArray = [nextleague, time, time]
	//let coordArray = [latlon2, time, time]
	//console.log(nameArray, leagueArray, coordArray);
	//convertTeamToGeoJSON("brett", nameArray, leagueArray, coordArray);
	let geoJSONteam = { 
		"type": "Feature",
	    "properties": 	{"start": time, "end": time, "name": name, "league": nextleague},
		"geometry" : 	{"coordinates" : [latlon2[1], latlon2[0]], "type": "Point"}} 
	//console.log(geoJSONteam, nextleague);
	addGeoJSONTeamsToLeagues(geoJSONteam, nextleague);		//but the extra marker goes with the joining league
}

function getDetailColor(colorIcon) {
			switch (colorIcon) {
				case ALIcon: 			return 	{color: "#404040"};
				case NLIcon: 			return 	{color: "#404040"};
				case NorthwoodsIcon: 	return 	{color: "#458F5C"};
				case redIcon: 			return 	{color: "#a32929"}; 
				case orangeIcon: 		return 	{color: "#F5A327"}; 
				case greenIcon: 		return 	{color: "#34D966"}; 
				case darkgreenIcon:	 	return 	{color: "#458F5C"}; 
				case goldIcon: 			return 	{color: "#F7D939"}; 
				case greyIcon: 			return 	{color: "#C4C4C4"}; 
				case blackIcon: 		return 	{color: "#404040"}; 
				case pinkIcon: 			return 	{color: "#ED6DB7"}; 
				case violetIcon: 		return 	{color: "#A55DF0"};
				case blueIcon: 			return 	{color: "#5D67F0"}; 
				case yellowIcon: 		return 	{color: "#E3DD4B"}; 
				case aquamarineIcon: 	return 	{color: "#65E0C9"}; }}


var blankStyle = {
    "color": "",
    "weight": 0,
    "opacity": 0
};


function getLeagueTimeline(team, ballIcon){
	let weight = 0
	teamTimeline = L.timeline(team, {
			style:  function (feature, layer) {;
				if (feature.geometry.properties.decoration == "leaguetext") {return blankStyle};
				return getDetailColor(ballIcon)
				}, 
				
				//blankStyle,
			onEachFeature: function (feature, layer) {
					if (feature.properties.decoration == "arrow") {
						layer.setText('â–º ', {repeat: true, offset: 4, attributes: {} })};
					if (feature.properties.decoration == "leaguetext") {
						layer.setText(feature.properties.league, {orientation: 180, center: true, attributes: { 'font-size': '35px', fill: "#34D966"} })} //get a Western League image and put it over the coords instead?
													},
				pointToLayer : function(feature, latlng) {
							if (feature.properties.marker) {
								return L.marker(latlng, {icon:feature.properties.marker}).setZIndexOffset(1000)}
							switch (feature.properties.league) {
								case "National League" : weight = 950;
								case "American League" : weight = 800
								}
							return L.marker(latlng, {icon:ballIcon}).bindPopup(feature.properties.name + "<br>" + feature.properties.league).setZIndexOffset(weight)}
							}		
							
							)
	if (ballIcon == NorthwoodsIcon) { //if the ballicon is this placeholder then give it the fancy update UI list thing
		return (teamTimeline).on('change', function() {rebuildLeagueUIList();}); }
	return (teamTimeline)
	}

function getRebuildLeagueUIListDateMarks () {
	for (let j = 1850; j < 2025; j++) {
		placeholderMarker = { "type": "Feature",
					"properties": 	{"start": cleanDates(j, "start"), "end": cleanDates(j, "end"), "name": "", marker: NorthwoodsIcon},
					"geometry" : 	{"coordinates" : [0, 0], "type": "Point"}}
					addGeoJSONTeamsToLeagues(placeholderMarker, "noLeague");
	}
}
getRebuildLeagueUIListDateMarks()




//make teams go defunct on december 30th?


function createEndMarker(endMarker, endCoords, endDate, endLeague){
	let geoJSONEndMarker = { 
		"type": "Feature",
	    "properties": 	{"start": endDate, "end": endDate, "name": "", marker: endMarker},
		"geometry" : 	{"coordinates" : [endCoords[0][1], endCoords[0][0]], "type": "Point"}}
	addGeoJSONTeamsToLeagues(geoJSONEndMarker, endLeague[0]);
	}




function loadTeams(teamFile){
	//console.log(teamFile);
	teamCount = teamFile.teams.length;
	teamIncrement = 0
	while (teamIncrement < teamCount) {
		currentTeam 	= 	teamFile.teams[teamIncrement];
		nameIncrement 	= 	0; 
		leagueIncrement = 	0;
		coordIncrement	=	0;
		nameCount 		= 	currentTeam.names.length;
		leagueCount		= 	currentTeam.leagues.length;
		coordCount 		= 	currentTeam.coords.length;
		while (	(nameIncrement 		< nameCount) 		&&  //while we're not on the last name 
				(leagueIncrement 	< leagueCount) 		&&  //AND not on the last league
				(coordIncrement 	< coordCount)		){	//AND not on the last coord for this team
			currentName 			= 	currentTeam.names[nameIncrement];
			currentLeague 			= 	currentTeam.leagues[leagueIncrement];
			currentCoord 			= 	currentTeam.coords[coordIncrement];
			currentNameEndTime		= 	cleanDates(currentName[2], 		"end");
			currentLeagueEndTime	= 	cleanDates(currentLeague[2], 	"end");
			currentCoordEndTime		= 	cleanDates(currentCoord[2], 	"end");
			convertedTeam 	= convertTeamToGeoJSON(currentTeam, currentName, currentLeague, currentCoord);
			if ((currentNameEndTime < currentLeagueEndTime) && 		//if NAME ends before LEAGUE and COORD
				(currentNameEndTime < currentCoordEndTime)) {
				nameIncrement 	= nameIncrement 	+ 1;
					continue;}
			if ((currentLeagueEndTime < currentNameEndTime) && 		//if LEAGUE ends before NAME and COORD	
				(currentLeagueEndTime < currentCoordEndTime)) {
				leagueIncrement = leagueIncrement 	+ 1;		
					continue;}
			if ((currentCoordEndTime < currentNameEndTime) && 		//if COORD ends before NAME and LEAGUE
				(currentCoordEndTime < currentLeagueEndTime)) {
				if (coordIncrement+1 != coordCount) {
					drawCoordMovingLines(	currentTeam.coords[coordIncrement][0],   	//currentcoord
											currentTeam.coords[coordIncrement+1][0], 	//coord of the next location
											currentCoordEndTime, 						//when the coord changes
											currentLeague[0], 							//current league (so we know which array to dump the line into)
											currentLeague[0],							//if the league is changing, the next league. (to generate the double point for a move) otherwise, current league
											currentName[0]);}
				coordIncrement 	= coordIncrement 	+ 1;		
					continue;}
			if ((currentLeagueEndTime < currentCoordEndTime) && 	//if NAME and LEAGUE end before COORD
				(currentNameEndTime == currentLeagueEndTime)) {
				nameIncrement 	= nameIncrement 	+ 1;	
				leagueIncrement = leagueIncrement 	+ 1;
					continue;}	
			if ((currentNameEndTime < currentLeagueEndTime) && 		//if NAME and COORD end before LEAGUE
				(currentCoordEndTime == currentNameEndTime)) {
				if (coordIncrement+1 != coordCount) {
					drawCoordMovingLines(	currentTeam.coords[coordIncrement][0], 
											currentTeam.coords[coordIncrement+1][0], 
											currentCoordEndTime, 
											currentLeague[0], 
											currentLeague[0],
											currentTeam.names[nameIncrement+1][0]);}
				coordIncrement 	= coordIncrement 	+ 1;	
				nameIncrement 	= nameIncrement 	+ 1;
					continue;}		
			if ((currentCoordEndTime < currentNameEndTime) && 		//if COORD and LEAGUE end before NAME
				(currentLeagueEndTime == currentCoordEndTime)) {
				if (coordIncrement+1 != coordCount) {
					drawCoordMovingLines(	currentTeam.coords[coordIncrement][0], 
											currentTeam.coords[coordIncrement+1][0], 
											currentCoordEndTime, 
											currentLeague[0], 
											currentTeam.leagues[leagueIncrement+1],
											currentName[0]);}
				coordIncrement 	= coordIncrement 	+ 1;	
				leagueIncrement = leagueIncrement 	+ 1;
					continue;}				
			if ((currentCoordEndTime == currentNameEndTime) && 		//if all end on same date
				(currentCoordEndTime == currentLeagueEndTime)) {
				if (coordIncrement+1 != coordCount) {				
					drawCoordMovingLines(	currentTeam.coords[coordIncrement][0], 
											currentTeam.coords[coordIncrement+1][0], 
											currentCoordEndTime, 
											currentLeague[0], 
											currentTeam.leagues[leagueIncrement+1][0],
											currentTeam.names[nameIncrement+1][0]);}
				if ((coordIncrement+1 == coordCount) && (currentCoord[2] != "now")) {
					//console.log("this if statement works");
					createEndMarker(defunctIcon, currentCoord, currentCoordEndTime, currentLeague)}
				coordIncrement 	= coordIncrement 	+ 1;	
				nameIncrement 	= nameIncrement 	+ 1;
				leagueIncrement = leagueIncrement 	+ 1;
					continue;}
			}
		teamIncrement = teamIncrement + 1;
		}
	
	

}	

var LeagueLayerTree = L.control.layers.tree(baseTree, overlaysTree1, null)
LeagueLayerTree.addTo(map);

leagueLayerArray = [[NoLeagueLayer 	= getLeagueTimeline(NoLeague, NorthwoodsIcon), "noLeague"],] //cheap quick hack to update the UI








function getLeagueLevel(leagueStr) {
	for  (let i = 0; i < leagueIndex.leagues.length; i++) {
		if (leagueIndex.leagues[i].name == leagueStr) {
			return timeCheck(leagueIndex.leagues[i].properties.levels);
			}
	}
	return 1
}	


var overlaysTree1 = 	{
    label: 'Leagues',
    selectAllCheckbox: 'Un/select all',
    children: [  {
			label: 'leagues but again',
            selectAllCheckbox: true,
            children: [] }     ]
			}



var baseTree = {
	children: [
        {label: "Light Mode", layer: CartoDB_LightMatter},
		{label: "Dark Mode", layer: CartoDB_DarkMatter},]}



function rebuildLeagueUIList() {                //whenever I need to rebuild the UI list
	var overlaysTree2 = 	{						//create an empty overlaysTree
		label: 'Leagues',
		selectAllCheckbox: 'Un/select all',
		children: [  
				{ label: '<b>Major Leagues</b>', selectAllCheckbox: true, children: [] },
				{ label: '<b>Minor Leagues</b>', selectAllCheckbox: true, children: [] },
				{ label: '<b>Independent</b>', selectAllCheckbox: true, collapsed: true, children: [] },
				{ label: '<b>Collegiate Summer</b>', selectAllCheckbox: true, collapsed: true, children: [] },		
				{ label: 'Sir-Not-Appearing-At-This-Time', selectAllCheckbox: true, collapsed: true, children: [] },					
				]
				}						
	LeagueLayerTree.remove();                   //remove the old one from the map
	if (((cleanDates("1890", "start")) <= timelineControl.time) && ((cleanDates("1901", "end")) >= timelineControl.time)) {
		
		overlaysTree2.children[1].children.push(
			{ label: 'Class A', selectAllCheckbox: true, children: [] }, 
			{ label: 'Class B', selectAllCheckbox: true, children: [] }, 
			{ label: 'Class C', selectAllCheckbox: true, children: [] }, 
			{ label: 'Class D', selectAllCheckbox: true, children: [] },
			{ label: 'Class E', selectAllCheckbox: true, children: [] },
			{ label: 'Class F', selectAllCheckbox: true, children: [] },			)
	}
	if (((cleanDates("1902", "start")) <= timelineControl.time) && ((cleanDates("1911", "end")) >= timelineControl.time)) {
		
		overlaysTree2.children[1].children.push(
			{ label: 'Class A', selectAllCheckbox: true, children: [] }, 
			{ label: 'Class B', selectAllCheckbox: true, children: [] }, 
			{ label: 'Class C', selectAllCheckbox: true, children: [] }, 
			{ label: 'Class D', selectAllCheckbox: true, children: [] }, )
	}
	if (((cleanDates("1912", "start")) <= timelineControl.time) && ((cleanDates("1935", "end")) >= timelineControl.time)) {
		
		overlaysTree2.children[1].children.push(
			{ label: 'Class AA', selectAllCheckbox: true, children: [] }, 
			{ label: 'Class A', selectAllCheckbox: true, children: [] }, 
			{ label: 'Class B', selectAllCheckbox: true, children: [] }, 
			{ label: 'Class C', selectAllCheckbox: true, children: [] }, 
			{ label: 'Class D', selectAllCheckbox: true, children: [] }, )
	}
	if (((cleanDates("1936", "start")) <= timelineControl.time) && ((cleanDates("1936", "end")) >= timelineControl.time)) {
		
		overlaysTree2.children[1].children.push(
			{ label: 'Class AA', selectAllCheckbox: true, children: [] }, 
			{ label: 'Class A1', selectAllCheckbox: true, children: [] }, 
			{ label: 'Class A', selectAllCheckbox: true, children: [] }, 
			{ label: 'Class B', selectAllCheckbox: true, children: [] }, 
			{ label: 'Class C', selectAllCheckbox: true, children: [] }, 
			{ label: 'Class D', selectAllCheckbox: true, children: [] }, )
	}
	if (((cleanDates("1937", "start")) <= timelineControl.time) && ((cleanDates("1945", "end")) >= timelineControl.time)) {
		
		overlaysTree2.children[1].children.push(
			{ label: 'Class AA', selectAllCheckbox: true, children: [] }, 
			{ label: 'Class A1', selectAllCheckbox: true, children: [] }, 
			{ label: 'Class A', selectAllCheckbox: true, children: [] }, 
			{ label: 'Class B', selectAllCheckbox: true, children: [] }, 
			{ label: 'Class C', selectAllCheckbox: true, children: [] }, 
			{ label: 'Class D', selectAllCheckbox: true, children: [] },
			{ label: 'Class E', selectAllCheckbox: true, children: [] },			)
	}
	if (((cleanDates("1946", "start")) <= timelineControl.time) && ((cleanDates("1951", "end")) >= timelineControl.time)) {
		
		overlaysTree2.children[1].children.push(
			{ label: 'Class AAA', selectAllCheckbox: true, children: [] }, 
			{ label: 'Class AA', selectAllCheckbox: true, children: [] }, 
			{ label: 'Class A', selectAllCheckbox: true, children: [] }, 
			{ label: 'Class B', selectAllCheckbox: true, children: [] }, 
			{ label: 'Class C', selectAllCheckbox: true, children: [] }, 
			{ label: 'Class D', selectAllCheckbox: true, children: [] },			)
	}
	if (((cleanDates("1952", "start")) <= timelineControl.time) && ((cleanDates("1957", "end")) >= timelineControl.time)) {
		
		overlaysTree2.children[1].children.push(
			{ label: 'Open', selectAllCheckbox: true, children: [] }, 
			{ label: 'Class AAA', selectAllCheckbox: true, children: [] }, 
			{ label: 'Class AA', selectAllCheckbox: true, children: [] }, 
			{ label: 'Class A', selectAllCheckbox: true, children: [] }, 
			{ label: 'Class B', selectAllCheckbox: true, children: [] }, 
			{ label: 'Class C', selectAllCheckbox: true, children: [] }, 
			{ label: 'Class D', selectAllCheckbox: true, children: [] },			)
	}
	if (((cleanDates("1958", "start")) <= timelineControl.time) && ((cleanDates("1962", "end")) >= timelineControl.time)) {
		
		overlaysTree2.children[1].children.push(
			{ label: 'Class AAA', selectAllCheckbox: true, children: [] }, 
			{ label: 'Class AA', selectAllCheckbox: true, children: [] }, 
			{ label: 'Class A', selectAllCheckbox: true, children: [] }, 
			{ label: 'Class B', selectAllCheckbox: true, children: [] }, 
			{ label: 'Class C', selectAllCheckbox: true, children: [] }, 
			{ label: 'Class D', selectAllCheckbox: true, children: [] },			)
	}
	if (((cleanDates("1963", "start")) <= timelineControl.time) && ((cleanDates("1964", "end")) >= timelineControl.time)) {
		
		overlaysTree2.children[1].children.push(
			{ label: 'Class AAA', selectAllCheckbox: true, children: [] }, 
			{ label: 'Class AA', selectAllCheckbox: true, children: [] }, 
			{ label: 'Class A', selectAllCheckbox: true, children: [] }, 
			{ label: 'Rookie', selectAllCheckbox: true, children: [] }, 			)
	}
	if (((cleanDates("1965", "start")) <= timelineControl.time) && ((cleanDates("1989", "end")) >= timelineControl.time)) {
		
		overlaysTree2.children[1].children.push(
			{ label: 'Class AAA', selectAllCheckbox: true, children: [] }, 
			{ label: 'Class AA', selectAllCheckbox: true, children: [] }, 
			{ label: 'Class A', selectAllCheckbox: true, children: [] }, 
			{ label: 'Class A-Short Season', selectAllCheckbox: true, children: [] }, 
			{ label: 'Rookie', selectAllCheckbox: true, children: [] }, 			)
	}
	if (((cleanDates("1990", "start")) <= timelineControl.time) && ((cleanDates("1990", "end")) >= timelineControl.time)) {
		
		overlaysTree2.children[1].children.push(
			{ label: 'Class AAA', selectAllCheckbox: true, children: [] }, 
			{ label: 'Class AA', selectAllCheckbox: true, children: [] }, 
			{ label: 'Class A-Advanced', selectAllCheckbox: true, children: [] }, 
			{ label: 'Class A', selectAllCheckbox: true, children: [] }, 
			{ label: 'Class A-Short Season', selectAllCheckbox: true, children: [] }, 
			{ label: 'Rookie', selectAllCheckbox: true, children: [] }, 			)
	}
	if (((cleanDates("1991", "start")) <= timelineControl.time) && ((cleanDates("2020", "end")) >= timelineControl.time)) {
		
		overlaysTree2.children[1].children.push(
			{ label: 'Class AAA', selectAllCheckbox: true, children: [] }, 
			{ label: 'Class AA', selectAllCheckbox: true, children: [] }, 
			{ label: 'Class A-Advanced', selectAllCheckbox: true, children: [] }, 
			{ label: 'Class A', selectAllCheckbox: true, children: [] }, 
			{ label: 'Class A-Short Season', selectAllCheckbox: true, children: [] }, 
			{ label: 'Rookie Advanced', selectAllCheckbox: true, children: [] }, 
			{ label: 'Rookie', selectAllCheckbox: true, children: [] }, 			)
	}
	if (((cleanDates("2021", "start")) <= timelineControl.time) && ((cleanDates("now", "end")) >= timelineControl.time)) {
		
		overlaysTree2.children[1].children.push(
			{ label: 'Class AAA', selectAllCheckbox: true, children: [] }, 
			{ label: 'Class AA', selectAllCheckbox: true, children: [] }, 
			{ label: 'Class A+', selectAllCheckbox: true, children: [] }, 
			{ label: 'Class A-', selectAllCheckbox: true, children: [] }, 
			{ label: 'Rookie', selectAllCheckbox: true, children: [] }, 			)
	}
	
	for (let i = 0; i < leagueLayerArray.length; i++) { //iterate thru leagueLayerArray, which contains all the leagueLayers
		leagueName = leagueLayerArray[i][1];
		leagueLevelNum = getLeagueLevel(leagueName)[0];
		subLeagueName = (getLeagueLevel(leagueName)[1]);
		subLeagueNum = null
		if (subLeagueName != null) {
		for (let j = 0; j < overlaysTree2.children[1].children.length; j++) {
			//console.log(j.label);
			if (subLeagueName == overlaysTree2.children[1].children[j].label) {subLeagueNum = j}} } //do not think about this again, ever
		if (leagueLevelNum <= 4) {
			if (subLeagueNum != null) {
			overlaysTree2.children[1].children[subLeagueNum].children.push({label:leagueLayerArray[i][1], layer:leagueLayerArray[i][0]})
			}
			else {
			overlaysTree2.children[leagueLevelNum].children.push({label:leagueLayerArray[i][1], layer:leagueLayerArray[i][0]})
			}
		}}
		
	//console.log(overlaysTree);
	LeagueLayerTree = L.control.layers.tree(baseTree, overlaysTree2, null)
	LeagueLayerTree.addTo(map);
	
}


					
						
						
function timeCheck(timeArray) {
for (let j = 0; j < timeArray.length; j++) {
	if (((cleanDates(timeArray[j][0], "start")) <= timelineControl.time) && ((cleanDates(timeArray[j][1], "end")) >= timelineControl.time)) {
		if (timeArray[j].length == 4 )
			{ return [timeArray[j][2], timeArray[j][3]]}
		return [timeArray[j][2], null]}
	
	}	


return [4, null];			//if it doesn't pass any of the checks then it doesn't exist 	
}


function getArrayNumOfLeagueLevel (leagueLvlStr) {
	console.log(overlaysTree2);
	for (let j = 0; j < overlaysTree2.children[1].children.length; j++) {
		if (leagueLvlStr == j.label) {return j}}}
		


function loadLeaguesFromIndex() {	//sends all obj mentioned in leagueIndex into the geoJSON processor
	for (let k = 0; k < leagueIndex.leagues.length; k++) 	{
	if (leagueIndex.leagues[k].properties.loadName != null) {
		loadTeams(eval(leagueIndex.leagues[k].properties.loadName)); }
	if (leagueIndex.leagues[k].properties.loadName2 != null) {
		loadTeams(eval(leagueIndex.leagues[k].properties.loadName2)); }
															}
processIndexGeoJSONintoTimelines()	
								}


function processIndexGeoJSONintoTimelines() {	
	for (let i = 0; i < leagueIndex.leagues.length; i++) 	{
		geoJSONArray = (leagueIndex.leagues[i].properties.leagueGeoJSONArray)
		leagueIndex.leagues[i].properties.leagueTimeline = getLeagueTimeline(geoJSONArray, eval(leagueIndex.leagues[i].properties.icon));
		leagueLayerArray.push([leagueIndex.leagues[i].properties.leagueTimeline, leagueIndex.leagues[i].name]);
															}	
	for (let i = 0; i < leagueLayerArray.length; i++) 	{
		leagueLayerArray[i][0].addTo(map);
		timelineControl.addTimelines(leagueLayerArray[i][0]);
														} 
											}									

loadLeaguesFromIndex();




timelineControl.addTo(map);
timelineControl.setTime(cleanDates("now", "end"));

</script> </body> </html>